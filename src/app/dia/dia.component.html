<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />

<!-- Botón a la izquierda -->

<div class="container-fluid px-4 mt-5 pt-5 mb-4">  <div class="row">
  <div class="row">
    <div class="col-auto">
      <a href="/supermercados" class="btn btn-verde-claro">
        Volver a supermercados
      </a>
    </div>
  </div>
</div>


<!-- Buscador centrado -->
<div class="container d-flex justify-content-center my-3">
  <input type="text" [(ngModel)]="terminoBusqueda" class="form-control buscador-input"
    placeholder="🔍 Buscar productos..." />
</div>

<!-- Spinner personalizado -->
<div *ngIf="cargando" class="spinner-wrapper">
  <img src="img/spinner.gif" alt="Cargando..." />
</div>

<!-- Mensaje de error -->
<div *ngIf="error" class="alert alert-danger text-center mx-4">
  {{ error }}
</div>

<!-- Cuadrícula de productos -->
<div *ngIf="!cargando && obtenerProductosPaginaActual().length > 0" class="container">
  <div class="row g-4">
    <div class="col-sm-6 col-md-4 col-lg-3" *ngFor="let producto of obtenerProductosPaginaActual()">
      <div class="card h-100 border-verde-claro position-relative shadow-sm">
        <!-- Logo supermercado -->
        <div class="position-absolute top-0 start-0 m-2">
          <img [src]="ImagenSupermercado(producto.supermercado)" alt="{{ producto.supermercado }}"
            class="logo-supermercado" />
        </div>

        <!-- Imagen del producto -->
        <img [src]="producto.link_imagen || 'assets/placeholder.jpg'" class="card-img-top imagen-producto"
          alt="{{ producto.nombre }}" />

        <!-- Información del producto -->
        <div class="card-body d-flex flex-column text-center">
          <h5 class="card-title text-truncate">{{ producto.nombre }}</h5>
          <p class="card-text fw-bold mb-1">
            Supermercado: {{ producto.supermercado }}
          </p>
          <p class="card-text text-danger fw-bold">
            {{ producto.precio | number: '1.2-2' }} €
          </p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Sin productos -->
<div *ngIf="!cargando && obtenerProductosPaginaActual().length === 0 && !error" class="text-center py-4">
  No se encontraron productos.
</div>

<!-- Paginación -->
<div *ngIf="totalPages > 1" class="d-flex justify-content-center align-items-center gap-3 my-5 flex-wrap">
  <button class="btn btn-verde-claro" (click)="anteriorPagina()" [disabled]="currentPage === 1">
    Anterior
  </button>

  <span class="fw-bold">Página {{ currentPage }} de {{ totalPages }}</span>

  <button class="btn btn-verde-claro" (click)="siguientePagina()" [disabled]="currentPage === totalPages">
    Siguiente
  </button>
</div>
